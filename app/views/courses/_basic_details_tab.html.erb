<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <dl class="govuk-summary-list govuk-!-margin-bottom-0">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Level
        </dt>
        <dd class="govuk-summary-list__value" data-qa="course__level">
          <%= course.level&.humanize %>
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <abbr class="app-text-decoration-underline-dotted" title="Special educational needs and disability">SEND</abbr>
        </dt>
        <dd class="govuk-summary-list__value" data-qa="course__is_send">
          <%= course.is_send? %>
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= 'Subject'.pluralize(course.subjects.count) %>
        </dt>
        <dd class="govuk-summary-list__value" data-qa="course__subjects">
          <%= course.sorted_subjects %>
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>

      <% unless course.level == 'further_education' %>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            Age range
          </dt>
          <dd class="govuk-summary-list__value" data-qa="course__age_range">
            <%= course.age_range %>
          </dd>
          <dd class="govuk-summary-list__actions"></dd>
        </div>
      <% end %>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Outcome
        </dt>
        <dd class="govuk-summary-list__value" data-qa="course__qualifications">
          <%= course.outcome %>
        </dd>
        <dd class="govuk-summary-list__actions">
          <%= link_to edit_provider_recruitment_cycle_course_outcome_path(@provider.provider_code, course.recruitment_cycle_year, course.course_code), class: "govuk-link", data: { qa: "course__edit_entry_requirements_link" } do %>
            Change<span class="govuk-visually-hidden"> outcome</span>
          <% end %>
        </dd>
      </div>

      <% if @provider.accredited_body? %>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            Apprenticeship
          </dt>
          <dd class="govuk-summary-list__value" data-qa="course__apprenticeship">
            <%= course.apprenticeship? %>
          </dd>
          <dd class="govuk-summary-list__actions"></dd>
        </div>
      <% else %>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            Fee or salary
          </dt>
          <dd class="govuk-summary-list__value" data-qa="course__funding">
            <%= course.funding %>
          </dd>
          <dd class="govuk-summary-list__actions"></dd>
        </div>
      <% end %>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Full or part time
        </dt>
        <dd class="govuk-summary-list__value" data-qa="course__study_mode">
          <%= course.study_mode.humanize %>
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Locations
        </dt>
        <dd class="govuk-summary-list__value" data-qa="course__locations">
          <% if course.sites.size == 1 %>
            <%= course.sites.first.location_name %>
          <% else %>
            <ul class="govuk-list app-courses-locations-list">
              <% course.alphabetically_sorted_sites.each do |site| %>
                <li>
                  <%= site.location_name %>
                </li>
              <% end %>
            </ul>
          <% end %>
          <% if @provider.sites.size == 1 %>
            <p class="govuk-body govuk-hint">You canâ€™t change this because you only have 1&nbsp;location</p>
            <p class="govuk-body">
              <%= link_to "Manage all your locations", provider_recruitment_cycle_sites_path(@provider.provider_code), class: "govuk-link", data: { qa: "course__manage_provider_locations_link" } %>
            </p>
          <% end %>
        </dd>
        <dd class="govuk-summary-list__actions">
          <% if @provider.sites.size > 1 %>
            <%= link_to locations_provider_recruitment_cycle_course_path(@provider.provider_code, course.recruitment_cycle_year, course.course_code), class: "govuk-link", data: { qa: "course__edit_locations_link" } do %>
              Change<span class="govuk-visually-hidden"> locations</span>
            <% end %>
          <% end %>
        </dd>
      </div>

      <% unless @provider.accredited_body? %>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            Accredited body
          </dt>
          <dd class="govuk-summary-list__value" data-qa="course__accredited_body">
            <%= course.accrediting_provider&.provider_name %>
          </dd>
          <dd class="govuk-summary-list__actions"></dd>
        </div>
      <% end %>

      <%#
        FIXME: This was showing the wrong information and isn't easily corrected
        https://trello.com/c/l0t1Oun3/

        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            Applications open
          </dt>
          <dd class="govuk-summary-list__value" data-qa="course__application_status">
          </dd>
          <dd class="govuk-summary-list__actions"></dd>
        </div>
      #%>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Course starts
        </dt>
        <dd class="govuk-summary-list__value" data-qa="course__start_date">
          <%= l(course.start_date&.to_date, format: :short) %>
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Title
        </dt>
        <dd class="govuk-summary-list__value" data-qa="course__name">
          <%= course.name %>
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Description
        </dt>
        <dd class="govuk-summary-list__value" data-qa="course__description">
          <%= course.description %>
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Course code
        </dt>
        <dd class="govuk-summary-list__value" data-qa="course__course_code">
          <%= course.course_code %>
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>
      <% if course.gcse_subjects_required.any? %>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            UCAS Apply: GCSE requirements for applicants
          </dt>
          <dd class="govuk-summary-list__value govuk-!-padding-right-0" data-qa="course__entry_requirements">
            <% course.gcse_subjects_required.each do |subject| %>
              <%= render partial: 'courses/entry_requirements',
                    locals: {
                      gcse_subject: subject.titleize,
                      gcse_subject_code: course[subject]
                    } %>
            <% end %>
          </dd>
          <dd class="govuk-summary-list__actions">
            <%= link_to entry_requirements_provider_recruitment_cycle_course_path(@provider.provider_code, course.recruitment_cycle_year, course.course_code), class: "govuk-link", data: { qa: "course__edit_entry_requirements_link" } do %>
              Change<span class="govuk-visually-hidden"> entry requirements</span>
            <% end %>
          </dd>
        </div>
      <% end %>
    </dl>
  </div>
  <% if course.is_running? || course.new_and_not_running? %>
    <aside class="govuk-grid-column-one-third">
      <div class="app-related">
        <h2 class="govuk-heading-m">Changing your basic details</h2>
        <p>At the moment you can change:</p>
        <ul class="govuk-list govuk-list--bullet">
          <li>course locations</li>
          <li>GCSE requirements</li>
        </ul>

        <p>To request other changes to your basic details contact the Becoming a Teacher team:<br /><%= bat_contact_mail_to bat_contact_email_address_with_wrap, subject: "Edit #{course.name} (#{@provider_code}/#{course.course_code})" %></p>
      </div>
    </aside>
  <% end %>
</div>
